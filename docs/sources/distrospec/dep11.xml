<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "AppStream.ent">
%BOOK_ENTITIES;
]>

<section id="sect-AppStream-DEP11">
	<title>Debian DEP-11 specification</title>

	<section id="spec-dep11-introduction">
		<title>Introduction</title>

		<para>
			DEP-11 is a YAML implementation of the AppStream Distro specification, which is primarily used by Debian and its derivatives.
			This document describes the DEP-11 YAML.
		</para>

		<important>
			<para>
				If you want to use AppStream in your distribution, and are not based on Debian, the first place to look at would be the XML specification.
			</para>
		</important>
	</section>


	<section id="spec-dep11-filenaming">
		<title>File naming and location</title>
		<para>
			Take a look at <xref linkend="spec-asxml-filenaming"/> for AppStream XML files. While the XML data belongs into the <filename>xmls</filename> subdirectory in
			<filename>/usr/share/app-info</filename> (or <filename>/var/cache/app-info</filename>), the YAML data is stored in the <filename>yaml</filename> subdirectory.
			All other rules affecting the XML apply the DEP-11 YAML as well, including the recommendation to compress the files with gzip.
		</para>
	</section>

	<section id="spec-dep11-general">
		<title>General DEP-11 YAML structure</title>
		<para>
			Each YAML file starts with a header document, which defines the basic properties of the metadata, which is followed by the actual metadata in form of one
			YAML document per AppStream component.
		</para>
		<para>
			The header document contains the following fields, all of them are required or at least strongly recommended.
		</para>
		<variablelist>
			<varlistentry>
			<term>File</term>
			<listitem>
				<para>
					This field identifies the file as DEP-11 file. Its value is always <code>DEP-11</code>.
				</para>
				<literallayout>Field info: <property>value-type</property>:<emphasis>str</emphasis>, <property>required</property>:<emphasis>yes</emphasis></literallayout>
			</listitem>
			</varlistentry>

			<varlistentry>
			<term>Version</term>
			<listitem>
				<para>
					The version of the AppStream specification this file was built for.
				</para>
				<literallayout>Field info: <property>value-type</property>:<emphasis>str</emphasis>, <property>required</property>:<emphasis>yes</emphasis></literallayout>
			</listitem>
			</varlistentry>

			<varlistentry>
			<term>Origin</term>
			<listitem>
				<para>
					Defines the repository-id this file belongs to. This usually matches the filename without extension. On Debian systems, it is the
					<code>&lt;suite&gt;-&lt;component&gt;</code> combination, e.g. <userinput>jessie-main</userinput>.
				</para>
				<literallayout>Field info: <property>value-type</property>:<emphasis>str</emphasis>, <property>required</property>:<emphasis>yes</emphasis></literallayout>
			</listitem>
			</varlistentry>

			<varlistentry>
			<term>AssetsUrl</term>
			<listitem>
				<para>
					The base URL for assets (screenshots, icons, ...) referenced in the metadata file.
				</para>
				<literallayout>Field info: <property>value-type</property>:<emphasis>str</emphasis>, <property>required</property>:<emphasis>no</emphasis></literallayout>
			</listitem>
			</varlistentry>
		</variablelist>
	</section>

	<section id="spec-dep11-translated">
		<title>Translated fields</title>
		<para>
			Fields with translated values follow the following conventions:
		</para>
		<orderedlist>
			<listitem><para>They are of type <emphasis>dict</emphasis></para></listitem>
			<listitem><para>They must contain a key <literal>C</literal>, containing the untranslated string as value</para></listitem>
			<listitem><para>All languages are represented as with their locale name as key in the dict and the translated string as value</para></listitem>
		</orderedlist>
		<para>
			In this document, the type <emphasis>translated</emphasis> is used to indicate that the field contains translated values following this schema.
		</para>
		<para>
			Example for a translated <literal>Name</literal> field:
		</para>
		<programlisting language="ruby">
<![CDATA[Name:
  C: I am the untranslated string.
  be@latin: Redaktar naładaŭ
  bg: Настройки на програмите
  pl: Edytor konfiguracji]]></programlisting>

	</section>

	<section id="spec-dep11-fields">
		<title>Valid fields</title>
		<para>
			This document describes all valid fields in the DEP-11 YAML specification. The requirements for the values are exactly the same as in the XML specification,
			and each field links to its correspondent XML tag for reference.
		</para>

		<variablelist>
			<varlistentry id="field-dep11-id">
			<term>ID</term>
			<listitem>
				<para>
					The <literal>ID</literal> field is a short unique and usually lower-cases identifier for the component.
					Depending on the component's type, different naming conventions apply.
				</para>
				<para>See <xref linkend="tag-distro-component-id"/>.</para>
				<literallayout>Field info: <property>value-type</property>:<emphasis>str</emphasis>, <property>required</property>:<emphasis>yes</emphasis></literallayout>
			</listitem>
			</varlistentry>

			<varlistentry id="field-dep11-type">
				<term>Type</term>
				<listitem>
					<para>
						The type of this component. Allowed values are:
					</para>
					<itemizedlist>
						<listitem><para><code>generic</code> for <xref linkend="sect-Metadata-GenericComponent"/></para></listitem>
						<listitem><para><code>desktop-app</code> for <xref linkend="sect-Metadata-Application"/></para></listitem>
						<listitem><para><code>addon</code> for <xref linkend="sect-Metadata-Addon"/></para></listitem>
						<listitem><para><code>codec</code> for <xref linkend="sect-Metadata-Codec"/></para></listitem>
						<listitem><para><code>inputmethod</code> for <xref linkend="sect-Metadata-InputMethod"/></para></listitem>
						<listitem><para><code>firmware</code> for <xref linkend="sect-Metadata-Firmware"/></para></listitem>
					</itemizedlist>

					<literallayout>Field info: <property>value-type</property>:<emphasis>str</emphasis>, <property>required</property>:<emphasis>yes</emphasis></literallayout>
				</listitem>
			</varlistentry>

			<varlistentry id="field-dep11-package">
				<term>Package</term>
				<listitem>
					<para>
						The name of the package which needs to be installed in order to make this component available on the system.
					</para>
					<para>See <xref linkend="tag-distro-pkgname"/>.</para>
					<literallayout>Field info: <property>value-type</property>:<emphasis>str</emphasis>, <property>required</property>:<emphasis>yes</emphasis></literallayout>
				</listitem>
			</varlistentry>

			<varlistentry id="field-dep11-name">
				<term>Name</term>
				<listitem>
					<para>See <xref linkend="tag-distro-name"/>.</para>
					<literallayout>Field info: <property>value-type</property>:<emphasis>translated</emphasis>, <property>required</property>:<emphasis>yes</emphasis></literallayout>
				</listitem>
			</varlistentry>

			<varlistentry id="field-dep11-summary">
				<term>Summary</term>
				<listitem>
					<para>See <xref linkend="tag-distro-summary"/>.</para>
					<literallayout>Field info: <property>value-type</property>:<emphasis>translated</emphasis>, <property>required</property>:<emphasis>yes</emphasis></literallayout>
				</listitem>
			</varlistentry>

			<varlistentry id="field-dep11-project_license">
				<term>ProjectLicense</term>
				<listitem>
					<para>See <xref linkend="tag-distro-project_license"/>.</para>
					<literallayout>Field info: <property>value-type</property>:<emphasis>str</emphasis></literallayout>
				</listitem>
			</varlistentry>

			<varlistentry id="field-dep11-description">
				<term>Description</term>
				<listitem>
					<para>See <xref linkend="tag-distro-description"/>.</para>
					<para>
						The markup for the description is the same as in the XML specification, so it can be read by anything
						parsing basic HTML markup.
					</para>
					<literallayout>Field info: <property>value-type</property>:<emphasis>translated</emphasis></literallayout>
				</listitem>
			</varlistentry>

			<varlistentry id="field-dep11-url">
				<term>Url</term>
				<listitem>
					<para>See <xref linkend="tag-distro-url"/>.</para>
					<para>
						The <literal>Url</literal> field contains the different url types as keys in its dict. Valid url types are
						defined in the main AppStream XML specification.
						All URL types must be lowercased.
					</para>
					<para>
						Example:
					</para>
					<programlisting><![CDATA[Url:
  homepage: http://example.org
  faq: http://example.org/faq
  bugtracker: http://bugs.example.org/report-issue]]></programlisting>

					<literallayout>Field info: <property>value-type</property>:<emphasis>dict</emphasis></literallayout>
				</listitem>
			</varlistentry>

		</variablelist>

	</section>


	<section id="spec-dep11-example">
		<title>Example YAML file</title>
		<para>
			This is an example AppStream DEP-11 metadata file:
		</para>
		<programlisting>
<![CDATA[---
File: DEP-11
Origin: chromodoris-main
Version: '0.6'
---
Categories:
  - GNOME
  - GTK
  - System
ID: gconf-editor.desktop
Icon:
  cached: gconf-editor_gconf-editor.png
Name:
  C: Configuration Editor
  be@latin: Redaktar naładaŭ
  bg: Настройки на програмите
  en@shaw: "\U00010452\U00010469\U0001046F\U00010453\U00010466\U0001045C\U00010458\U0001047C\U00010471\
    \U00010456\U00010469\U0001046F \U00010467\U0001045B\U00010466\U00010451\U00010479"
  pl: Edytor konfiguracji
Package: gconf-editor
Summary:
  C: Directly edit your entire configuration database
  ar: حرّر مباشرة كامل قاعدة بيانات الإعدادات.
  de: Direkten Zugriff auf Ihre gesamte Konfigurationsdatenbank erlangen
Type: desktop-app
---
Categories:
  - Qt
  - KDE
  - AudioVideo
  - Player
ID: kmplayer.desktop
Icon:
  cached: kmplayer_kmplayer.png
Name:
  C: KMPlayer
  hi: केएम-प्लेयर
  hne: केएम-प्लेयर
  ku: KMLêdar
  pa: KM-ਪਲੇਅਰ
  sr: КМ‑плејер
  sr@ijekavian: КМ‑плејер
  sv: Kmplayer
Package: kmplayer
Provides:
  mimetypes:
    - application/ogg
    - application/smil
    - application/vnd.ms-asf
    - application/vnd.rn-realmedia
    - application/x-kmplayer
    - video/webm
    - video/x-avi
Summary:
  C: KDE interface for MPlayer
Type: desktop-app
---
Categories:
  - Office
  - Publishing
Description:
  C: <p>TeXstudio is an integrated writing environment for creating LaTeX documents. It integrates editing,
    building and viewing into a single frontend.</p><p>Our goal is to make writing LaTeX as easy and comfortable
    as possible. This is achieved through a rich feature set including:</p>
ID: texstudio.desktop
Icon:
  cached: texstudio_texstudio.png
Keywords:
  C:
    - editor
    - latex
    - pdflatex
    - xelatex
    - lualatex
    - context
    - bibtex
Name:
  C: TeXstudio
Package: texstudio
ProjectLicense: GPL-2.0
Provides:
  mimetypes:
    - text/x-tex
Screenshots:
  - default: true
    source-image:
      height: 756
      url: http://metadata.tanglu.org/dep11/main/texstudio_2.8.4+debian-3_amd64/screenshots/source/screenshot-1.png
      width: 1344
    thumbnails:
      - height: 423
        url: http://metadata.tanglu.org/dep11/main/texstudio_2.8.4+debian-3_amd64/screenshots/752x423/screenshot-1.png
        width: 752
      - height: 351
        url: http://metadata.tanglu.org/dep11/main/texstudio_2.8.4+debian-3_amd64/screenshots/624x351/screenshot-1.png
        width: 624
      - height: 63
        url: http://metadata.tanglu.org/dep11/main/texstudio_2.8.4+debian-3_amd64/screenshots/112x63/screenshot-1.png
        width: 112
Summary:
  C: LaTeX development environment
  fr: Environnement de développement LaTeX
Type: desktop-app
Url:
  homepage: http://texstudio.sourceforge.net/
---]]></programlisting>

	</section>
</section>
